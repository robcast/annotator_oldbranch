<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>JS annotation test</title>

    <script src="lib/vendor/jquery.js"></script>
    <script src="lib/vendor/json2.js"></script>
    <script src="lib/vendor/showdown.js"></script>

    <script src="lib/extensions.js"></script>
    <script src="lib/console.js"></script>
    <script src="lib/class.js"></script>
    <script src="lib/range.js"></script>
    <script src="lib/annotator.js"></script>
    <script src="lib/widget.js"></script>
    <script src="lib/editor.js"></script>
    <script src="lib/viewer.js"></script>
    <script src="lib/notification.js"></script>
    <script src="lib/plugin/store.js"></script>
    <script src="lib/plugin/permissions.js"></script>
    <!-- <script src="lib/plugin/annotateitpermissions.js"></script> -->
    <script src="lib/plugin/authlogin.js"></script>
    <script src="lib/plugin/tags.js"></script>
    <script src="lib/plugin/markdown.js"></script>
    <script src="lib/plugin/unsupported.js"></script>
    <!-- <script src="lib/plugin/filter.js"></script> -->
    <script src="lib/plugin/digilibintegrator.js"></script>

    <link rel="stylesheet" type="text/css" href="css/annotator.css">

        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.tools.min.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.cookie.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.geometry.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.arrows.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.range.js"></script>
        <link rel="stylesheet" type="text/css" href="../digilib/webapp/src/main/webapp/jquery/jquery.range.css" />
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.buttons.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.dialogs.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.sliders.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.birdseye.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.marks.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.regions.js"></script>
        <script type="text/javascript" src="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.annotator.js"></script>
        <link rel="stylesheet" type="text/css" href="../digilib/webapp/src/main/webapp/jquery/jquery.digilib.css" />

        <script type="text/javascript">
            $(document).ready(function(){
                var $div = $('div#digilib');
                var devAnnotator = null; //new Annotator($div.get(0));
                var opts = {
                	// base URL to digilib (e.g. 'http://digilib.mpiwg-berlin.mpg.de/digitallibrary')
                    'digilibBaseUrl' : 'http://localhost:18080/digilib-webapp',
                    // base URL to Scaler servlet (usually digilibBaseUrl+'/servlet/Scaler')
                    //'scalerBaseUrl' : null,                    
                    interactionMode : 'fullscreen',
                    showRegionNumbers : true,
                    // annotator
                    'annotatorInstance' : devAnnotator,
                    // URL of annotation server
                    'annotationServerUrl' : 'http://localhost:18080/AnnotationManager/annotator',
                    //'annotationServerUrl' : 'http://tuxserve03.mpiwg-berlin.mpg.de/AnnotationManager/annotator',
                    // URL of authentication token server
                    'annotationTokenUrl' : 'http://localhost:8080/test/docuviewa/template/token/getLoginToken',
                    'annotatorPlugins' : {
                		'Markdown' : {},
                        'Permissions' : { 
                        	//user: data.settings.annotationUser,
                            userString : function(user) {
                                if (user && user.name) {
                                    return user.name;
                                }
                                return user;
                            }, 
                            userId: function (user) {
                                if (user && user.id) {
                                    return user.id;
                                }
                                return user;
                            }
                        }

                    }
                    };
                $div.digilib(opts);

                var elem = $div.get(0); //document.getElementById('airlock');
                var uri = window.location.href.split(/#|\?/).shift();

});

        </script>
    </head>

    <body>
        <div id="digilib">
            <p>digilib doesn't work! Please switch on Javascript or notify the server administrator!</p>
            <img src="http://digilib.berlios.de/images/digilib-logo-big.png" />
        </div>
    </body>

<!-- </head>

  <body>
    <header>
      <h1>Javascript annotation service test</h1>
    </header>

    <div id="airlock">
      <p><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. <em>Aenean ultricies mi vitae est.</em> Mauris placerat eleifend leo. Quisque sit amet est et sapien ullamcorper pharetra. Vestibulum erat wisi, condimentum sed, <code>commodo vitae</code>, ornare sit amet, wisi. Aenean fermentum, elit eget tincidunt condimentum, eros ipsum rutrum orci, sagittis tempus lacus enim ac dui. <a href="#">Donec non enim</a> in turpis pulvinar facilisis. Ut felis.</p>

      <h2>Header Level 2</h2>

      <ol>
         <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>
         <li>Aliquam tincidunt mauris eu risus.</li>
      </ol>

      <blockquote><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus magna. Cras in mi at felis aliquet congue. Ut a est eget ligula molestie gravida. Curabitur massa. Donec eleifend, libero at sagittis mollis, tellus est malesuada tellus, at luctus turpis elit sit amet quam. Vivamus pretium ornare est.</p></blockquote>

      <h3>Header Level 3</h3>

      <ul>
         <li id="listone">Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>
         <li id="listtwo">Aliquam tincidunt mauris eu risus.</li>
      </ul>

      <pre><code>
      #header h1 a {
        display: block;
        width: 300px;
        height: 80px;
      }
      </code></pre>

      <table>
        <thead>
          <tr>
            <td>Heading One</td>
            <td>Heading Two</td>
            <td>Heading Three</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>Side One</th>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
          </tr>
          <tr>
            <th>Side Two</th>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
          </tr>
          <tr>
            <th>Side Three</th>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
          </tr>
          <tr>
            <th>Side Four</th>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
            <td>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</td>
          </tr>
        </tbody>
      </table>
    </div>

    <script>
      var devAnnotator
      (function ($) {
        var elem = document.getElementById('airlock');
        var uri = window.location.href.split(/#|\?/).shift();

        var devAnnotator = new Annotator(elem)
          //.addPlugin('Auth')
          //.addPlugin('Unsupported')
          /* .addPlugin('Filter', {
            addAnnotationFilter: false
          }) */
          //.addPlugin('Tags')
          .addPlugin('Auth', {
            //tokenUrl: 'http://annotateit.org/api/token'
            tokenUrl: 'http://localhost:8080/test/annotator/token?user=casties'
            //autoFetch: false
          })
          .addPlugin('Permissions', {
            user: 'casties',
            userString: function (user) {
              if (user && user.name) {
                return user.name;
              }
              return user;
            },
            userId: function (user) {
              if (user && user.id) {
                return user.id;
              }
              return user;
            }
          })
          .addPlugin('Store', {
            prefix: 'http://localhost:18080/AnnotationManager/annotator',
            //prefix: 'http://tuxserve03.mpiwg-berlin.mpg.de/AnnotationManager/annotator',
            //prefix: 'http://annotateit.org/api',
            annotationData: {
              'uri': uri
            },
            loadFromSearch: {
              'limit': 20,
              'uri': uri
              //'uri': 'http://127.0.0.1:18080/ECHOdocuViewfullTest?pn=21&url=/mpiwg/online/permanent/library/163127KK'
            }
          })
          ;

      }(jQuery));
    </script>
  </body>
-->

</html>
